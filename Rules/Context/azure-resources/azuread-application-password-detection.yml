rules:
  - id: context-azuread-application-password
    message: |
      Azure AD application password/secret detected.
    severity: INFO
    languages: [terraform, hcl]
    pattern: |
      resource "azuread_application_password" $NAME {
        ...
        application_object_id = $APP_OBJ
        ...
      }
    metadata:
      rule_type: context_discovery
      category: identity
      subcategory: application_secret
      technology: [terraform, azuread, identity]
      target_files: ["*.tf", "**/*.tf"]
      extracts:
        service_type: Azure AD Application Password
        resource_type: azuread_application_password
        resource_name: $NAME
        properties:
          - name: application_object_id
            pattern: application_object_id = $APP_OBJ
          - name: display_name
            pattern: display_name = "$DISPLAY"
          - name: end_date_relative
            pattern: end_date_relative = "$END_REL"
    description: |
      Detects Azure AD application password resources to map credential lifecycles tied to app registrations.
