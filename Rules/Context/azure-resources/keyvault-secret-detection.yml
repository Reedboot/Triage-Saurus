rules:
  - id: context-azure-keyvault-secret
    message: |
      Azure Key Vault secret resource detected.
    severity: INFO
    languages: [terraform, hcl]
    pattern: |
      resource "azurerm_key_vault_secret" $NAME {
        ...
        key_vault_id = $KV
        ...
      }
    metadata:
      rule_type: context_discovery
      category: secrets-management
      subcategory: keyvault
      technology: [terraform, azure, keyvault]
      target_files: ["*.tf", "**/*.tf"]
      extracts:
        service_type: Key Vault Secret
        resource_type: azurerm_key_vault_secret
        resource_name: $NAME
        properties:
          - name: key_vault_id
            pattern: key_vault_id = $KV
    description: |
      Detects Key Vault secret provisioning to understand secrets distribution.
