rules:
  - id: context-aws-resources-generic
    message: |
      AWS resource detected in Terraform configuration.
      This generic rule extracts ALL AWS resources for LLM interpretation.
    severity: INFO
    languages: [terraform, hcl]
    pattern-regex: |
      resource\s+"aws_([a-z0-9_]+)"\s+"([a-z0-9_-]+)"\s*\{
    metadata:
      rule_type: context_discovery
      category: infrastructure
      subcategory: generic
      technology: [terraform, aws]
      target_files: ["*.tf", "**/*.tf"]
      requires_llm: true
      llm_prompt: |
        Interpret this AWS resource type and categorize it.
        
        Resource type: ${resource_type}
        Resource name: ${resource_name}
        
        Provide:
        1. Friendly service name (e.g., "aws_db_instance" → "RDS Database")
        2. Service category (database, storage, compute, networking, security, etc.)
        3. Whether this is a critical security-relevant service
        4. What security rules should be considered for this resource
        
        Format:
        {
          "service_name": "RDS Database",
          "category": "database",
          "security_relevant": true,
          "suggested_security_rules": ["rds-encryption", "rds-public-access", "rds-backup"]
        }
      extracts:
        provider: aws
        resource_type: $TYPE
        resource_name: $NAME
      description: |
        Generic AWS resource detector that captures ALL aws_* resources.
        The LLM interprets the resource_type to provide friendly names and categorization.
        
        Examples:
        - aws_db_instance → "RDS Database" (database)
        - aws_s3_bucket → "S3 Bucket" (storage)
        - aws_iam_role → "IAM Role" (security/identity)
        - aws_lambda_function → "Lambda Function" (compute/serverless)
