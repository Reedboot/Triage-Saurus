rules:
  - id: context-kubernetes-resources-generic
    message: |
      Kubernetes resource detected in YAML manifests.
      This generic rule extracts ALL Kubernetes resources for LLM interpretation.
    severity: INFO
    languages: [yaml]
    pattern-regex: |
      kind:\s*([A-Za-z]+)\s*\nmetadata:\s*\n\s+name:\s*([a-z0-9-]+)
    metadata:
      rule_type: context_discovery
      category: infrastructure
      subcategory: generic
      technology: [kubernetes, k8s]
      target_files: ["*.yaml", "*.yml", "**/*.yaml", "**/*.yml"]
      requires_llm: true
      llm_prompt: |
        Interpret this Kubernetes resource kind and categorize it.
        
        Kind: ${kind}
        Name: ${name}
        Namespace: ${namespace}
        
        Provide:
        1. Friendly service name (e.g., "Deployment" → "Deployment")
        2. Resource category (workload, networking, security, storage, config, etc.)
        3. Whether this is a critical security-relevant resource
        4. What security rules should be considered for this resource
        
        Format:
        {
          "service_name": "Deployment",
          "category": "workload",
          "security_relevant": true,
          "suggested_security_rules": ["privileged-container", "run-as-root", "security-context"]
        }
      extracts:
        kind: $KIND
        name: $NAME
        namespace: Optional, from metadata.namespace
      description: |
        Generic Kubernetes resource detector that captures ALL kinds.
        The LLM interprets the kind to provide categorization and security guidance.
        
        Examples:
        - Deployment → "Deployment" (workload)
        - Service → "Service" (networking)
        - Secret → "Secret" (security)
        - PersistentVolumeClaim → "PVC" (storage)
        - Ingress → "Ingress" (networking/routing)
