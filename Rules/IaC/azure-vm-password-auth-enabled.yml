rules:
  - id: azure-vm-password-auth-enabled
    message: |
      Linux VM allows password authentication.
      Passwords are vulnerable to brute force. Set
      disable_password_authentication = true and use SSH keys.
    severity: ERROR
    languages: [terraform, hcl]
    pattern: |
      resource "azurerm_linux_virtual_machine" "$NAME" {
        ...
        disable_password_authentication = false
        ...
      }
    metadata:
      category: security
      subcategory: [authentication, cloud]
      cwe: CWE-521
      confidence: HIGH
      likelihood: HIGH
      impact: HIGH
      technology: [terraform, azure]
      five_pillars: Pillar 2 (Access Control)
