rules:
  - id: hardcoded-aws-credentials-k8s
    message: |
      Hardcoded AWS Access Key ID and Secret Access Key found in environment variables.
      This allows anyone with access to the manifest or pod to gain unauthorized access to the AWS account.
      Remove hardcoded credentials and use IAM Roles for Service Accounts (IRSA) or Pod Identity.
    severity: ERROR
    languages: [yaml]
    pattern-either:
      - pattern-regex: "AKIA[0-9A-Z]{16}"
      - pattern-regex: "(?i)aws_secret_access_key.*[A-Za-z0-9/+=]{40}"
    metadata:
      category: security
      subcategory: [secrets]
      cwe: CWE-798
      confidence: HIGH
      likelihood: HIGH
      impact: CRITICAL
      technology: [kubernetes, aws]
